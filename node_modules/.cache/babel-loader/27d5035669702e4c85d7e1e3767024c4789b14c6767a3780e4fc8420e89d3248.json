{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\GGPC\\\\aeroclub-bookings\\\\src\\\\pages\\\\Scheduler\\\\Scheduler.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport resourceTimelinePlugin from '@fullcalendar/resource-timeline';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport { useAppContext } from '../../context/AppContext';\nimport './Scheduler.css';\nimport './ConfirmationDialog.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Scheduler = () => {\n  _s();\n  const {\n    staffList,\n    aircraftList,\n    bookings,\n    setBookings,\n    membersList\n  } = useAppContext();\n  const [showConfirmationDialog, setShowConfirmationDialog] = useState(false);\n  const [draggedEventInfo, setDraggedEventInfo] = useState(null);\n\n  // Convert bookings to calendar events format\n  const calendarEvents = bookings.flatMap(booking => {\n    const member = membersList.find(m => m.id === booking.memberId);\n    const memberName = member ? `${member.firstName} ${member.lastName}` : 'Unknown Member';\n    return [{\n      id: booking.id,\n      title: memberName,\n      start: booking.dateTime,\n      end: booking.endDateTime,\n      resourceId: booking.aircraftId,\n      extendedProps: {\n        ...booking\n      }\n    }, booking.staffId && {\n      id: booking.id,\n      title: memberName,\n      start: booking.dateTime,\n      end: booking.endDateTime,\n      resourceId: booking.staffId,\n      extendedProps: {\n        ...booking\n      }\n    }].filter(Boolean);\n  });\n  const handleEventDrop = info => {\n    info.revert(); // Prevent immediate update\n    setDraggedEventInfo(info);\n    setShowConfirmationDialog(true);\n  };\n  const handleConfirm = () => {\n    const {\n      event,\n      newResource\n    } = draggedEventInfo;\n    const updatedBooking = {\n      ...bookings.find(b => b.id === event.id),\n      dateTime: event.startStr,\n      endDateTime: event.endStr,\n      ...(newResource && {\n        [newResource.groupId === 'staff' ? 'staffId' : 'aircraftId']: newResource.id\n      })\n    };\n    setBookings(bookings.map(b => b.id === updatedBooking.id ? updatedBooking : b));\n    setShowConfirmationDialog(false);\n    setDraggedEventInfo(null);\n  };\n  const handleCancel = () => {\n    setShowConfirmationDialog(false);\n    setDraggedEventInfo(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"scheduler-container\",\n    children: [/*#__PURE__*/_jsxDEV(FullCalendar, {\n      plugins: [resourceTimelinePlugin, interactionPlugin],\n      initialView: \"resourceTimelineWeek\",\n      editable: true,\n      droppable: true,\n      resources: [{\n        id: 'staff',\n        title: 'Staff',\n        children: staffList.map(s => ({\n          id: s.id,\n          title: `${s.firstName} ${s.lastName}`\n        }))\n      }, {\n        id: 'aircraft',\n        title: 'Aircraft',\n        children: aircraftList.map(a => ({\n          id: a.id,\n          title: `${a.type} (${a.registration})`\n        }))\n      }],\n      events: calendarEvents,\n      eventDrop: handleEventDrop,\n      resourceGroupField: \"title\",\n      eventOverlap: false,\n      eventConstraint: {\n        startTime: '06:00',\n        endTime: '20:00'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), showConfirmationDialog && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"confirmation-dialog\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"confirmation-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Confirm Rescheduling\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Are you sure you want to reschedule this booking?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"confirmation-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"cancel-btn\",\n            onClick: handleCancel,\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"confirm-btn\",\n            onClick: handleConfirm,\n            children: \"Confirm\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};\n_s(Scheduler, \"61Tt2nMSC+IfOO23FV2jhvxm3eY=\", false, function () {\n  return [useAppContext];\n});\n_c = Scheduler;\nexport default Scheduler;\nvar _c;\n$RefreshReg$(_c, \"Scheduler\");","map":{"version":3,"names":["React","useState","FullCalendar","resourceTimelinePlugin","interactionPlugin","useAppContext","jsxDEV","_jsxDEV","Scheduler","_s","staffList","aircraftList","bookings","setBookings","membersList","showConfirmationDialog","setShowConfirmationDialog","draggedEventInfo","setDraggedEventInfo","calendarEvents","flatMap","booking","member","find","m","id","memberId","memberName","firstName","lastName","title","start","dateTime","end","endDateTime","resourceId","aircraftId","extendedProps","staffId","filter","Boolean","handleEventDrop","info","revert","handleConfirm","event","newResource","updatedBooking","b","startStr","endStr","groupId","map","handleCancel","className","children","plugins","initialView","editable","droppable","resources","s","a","type","registration","events","eventDrop","resourceGroupField","eventOverlap","eventConstraint","startTime","endTime","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_c","$RefreshReg$"],"sources":["C:/Users/GGPC/aeroclub-bookings/src/pages/Scheduler/Scheduler.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport FullCalendar from '@fullcalendar/react';\r\nimport resourceTimelinePlugin from '@fullcalendar/resource-timeline';\r\nimport interactionPlugin from '@fullcalendar/interaction';\r\nimport { useAppContext } from '../../context/AppContext';\r\n\r\nimport './Scheduler.css';\r\nimport './ConfirmationDialog.css';\r\n\r\nconst Scheduler = () => {\r\n  const {\r\n    staffList,\r\n    aircraftList,\r\n    bookings,\r\n    setBookings,\r\n    membersList\r\n  } = useAppContext();\r\n\r\n  const [showConfirmationDialog, setShowConfirmationDialog] = useState(false);\r\n  const [draggedEventInfo, setDraggedEventInfo] = useState(null);\r\n\r\n  // Convert bookings to calendar events format\r\n  const calendarEvents = bookings.flatMap(booking => {\r\n    const member = membersList.find(m => m.id === booking.memberId);\r\n    const memberName = member ? `${member.firstName} ${member.lastName}` : 'Unknown Member';\r\n    return [\r\n      {\r\n        id: booking.id,\r\n        title: memberName,\r\n        start: booking.dateTime,\r\n        end: booking.endDateTime,\r\n        resourceId: booking.aircraftId,\r\n        extendedProps: { ...booking }\r\n      },\r\n      booking.staffId && {\r\n        id: booking.id,\r\n        title: memberName,\r\n        start: booking.dateTime,\r\n        end: booking.endDateTime,\r\n        resourceId: booking.staffId,\r\n        extendedProps: { ...booking }\r\n      }\r\n    ].filter(Boolean);\r\n  });\r\n\r\n  const handleEventDrop = (info) => {\r\n    info.revert(); // Prevent immediate update\r\n    setDraggedEventInfo(info);\r\n    setShowConfirmationDialog(true);\r\n  };\r\n\r\n  const handleConfirm = () => {\r\n    const { event, newResource } = draggedEventInfo;\r\n\r\n    const updatedBooking = {\r\n      ...bookings.find(b => b.id === event.id),\r\n      dateTime: event.startStr,\r\n      endDateTime: event.endStr,\r\n      ...(newResource && {\r\n        [newResource.groupId === 'staff' ? 'staffId' : 'aircraftId']: newResource.id\r\n      })\r\n    };\r\n\r\n    setBookings(bookings.map(b => (b.id === updatedBooking.id ? updatedBooking : b)));\r\n    setShowConfirmationDialog(false);\r\n    setDraggedEventInfo(null);\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setShowConfirmationDialog(false);\r\n    setDraggedEventInfo(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"scheduler-container\">\r\n      <FullCalendar\r\n        plugins={[resourceTimelinePlugin, interactionPlugin]}\r\n        initialView=\"resourceTimelineWeek\"\r\n        editable\r\n        droppable\r\n        resources={[\r\n          { id: 'staff', title: 'Staff', children: staffList.map(s => ({ id: s.id, title: `${s.firstName} ${s.lastName}` })) },\r\n          { id: 'aircraft', title: 'Aircraft', children: aircraftList.map(a => ({ id: a.id, title: `${a.type} (${a.registration})` })) }\r\n        ]}\r\n        events={calendarEvents}\r\n        eventDrop={handleEventDrop}\r\n        resourceGroupField=\"title\"\r\n        eventOverlap={false}\r\n        eventConstraint={{ startTime: '06:00', endTime: '20:00' }}\r\n      />\r\n      {showConfirmationDialog && (\r\n        <div className=\"confirmation-dialog\">\r\n          <div className=\"confirmation-content\">\r\n            <h3>Confirm Rescheduling</h3>\r\n            <p>Are you sure you want to reschedule this booking?</p>\r\n            <div className=\"confirmation-buttons\">\r\n              <button className=\"cancel-btn\" onClick={handleCancel}>Cancel</button>\r\n              <button className=\"confirm-btn\" onClick={handleConfirm}>Confirm</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Scheduler;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}